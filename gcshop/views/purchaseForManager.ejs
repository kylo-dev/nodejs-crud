<form id="orderForm">

    <table class="table table-bordered">
        <tr>
            <td rowspan="6" style="width: 65%;">
                <img id="productImage" src="/images/wait.png" alt="상품 이미지" style="width: 30%;">
            </td>
        </tr>

        <tr>
            <td>
                <label for="merId">상품 선택:</label>
                <select id="merId" name="merId" onchange="updateProductInfo()">
                <% var i = 0;
                    while(i<list.length){ %>
                        <option value="<%=list[i].mer_id%>"><%=list[i].name%></option>
                <% i += 1 } %>
                </select>
            </td>
        </tr>

        <tr>
            <td>
                <p id="productName">브랜드 :</p>
            </td>
        </tr>

        <tr>
            <td>
                <p id="productPrice">가격 : </p>
            </td>
        </tr>

        <tr>
            <td>
                <label for="quantity">수량:</label>
                <input type="number" id="quantity" name="quantity" min="1" value="1">
            </td>
        </tr>
        
        <tr>
            <td>
                <button onclick="submitOrder()">주문</button>
            </td>
        </tr>
    </table>
</form>
    <!-- <label for="merId">상품 선택:</label>
    <select id="merId" name="merId" onchange="updateProductInfo()">
      <% var i = 0;
        while(i<list.length){ %>
            <option value="<%=list[i].mer_id%>"><%=list[i].name%></option>
      <% i += 1 } %>
    </select>
  
    <div>
      <img id="productImage" src="/images/wait.png" alt="상품 이미지" style="width: 100px;">
    </div> -->
  
    <!-- <div>
      <p id="productName">브랜드 :</p>
      <p id="productPrice">가격 : </p>
    </div> -->

<script>
async function updateProductInfo() {
    var selectedMerId = document.getElementById('merId').value;

    fetch(`/purchase/manage/merchandise/${selectedMerId}`)
    .then(function(response) {
      // 응답이 성공적인지 확인
      if (!response.ok) {
        throw new Error('Network response was not ok');
      }
      // JSON으로 파싱된 응답 반환
      return response.json();
    })
    .then(function(res) {
      // 상품 이미지 업데이트
      document.getElementById('productImage').src = res[0].image;

      // 상품 이름 업데이트
      document.getElementById('productName').innerText = '상품명: ' + res[0].name;

      // 상품 가격 업데이트
      document.getElementById('productPrice').innerText = '가격: ' + res[0].price + ' 원';
    })
    .catch(function(error) {
      console.error('Error fetching product data:', error);
    });
}

function submitOrder() {
    var form = document.getElementById('orderForm');
    // 여기에서 주문을 서버로 전송하는 로직을 추가해야 합니다.
    console.log('주문 데이터:', {
    merId: form.elements['merId'].value,
    quantity: form.elements['quantity'].value
    });
}
</script>